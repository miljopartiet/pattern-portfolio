(function(e){"use strict";var t={};t.CookieChecker=function(){var t=e.cookie("allow-cookies"),n;t||(n=e("#cookies"),n.bind("click","a.confirm",function(t){t.preventDefault(),n.hide(),e.cookie("allow-cookies",!0,{expires:365,path:"/"})}),e("body").prepend(n.show()))},t.searchAsYouType=function(){var t,n,r,i,s,o=-1,u=[],a={16:null,27:function(){d(),t.blur()},37:null,38:function(e){m(),e.preventDefault(e)},39:null,40:function(e){v(),e.preventDefault()},9:function(e){e.shiftKey?m():v(),e.preventDefault()},13:function(e){e.preventDefault(),n.find("a.focused").trigger("click")}},f=function(o,u){t=e(o);if(t.size()==0)return;n=e('<div id="search-suggestions" class="suggestions" style="display:none;position:absolute;"></div>'),n.css({width:t.outerWidth()+"px"});var f=e("body");r=parseInt(f.css("paddingLeft"),10),i=parseInt(f.css("paddingTop"),10)+t.outerHeight(),s=e.extend({source:[],onShow:e.noop,onHide:e.noop},u||{}),typeof s.source=="function"&&(s.source=s.source.call(this)),t.bind("keydown.autocomplete",function(e){var t=a[e.keyCode.toString()];typeof t=="function"&&t.call(this,e)}).bind("keyup.autocomplete",function(e){if(typeof a[e.keyCode.toString()]!="undefined"){e.preventDefault();return}l(t.val())}).bind("focus.autocomplete",function(){e.trim(t.val())!==""&&p()}).bind("blur.autocomplete",function(){g(-1)}),e(window).bind("resize.autocomplete",y),n.appendTo("body")},l=function(t){var t=e.trim(t);t===""?(h([]),d()):t!==""&&(h(c(t)),n.is(":hidden")&&p())},c=function(t){var n=new RegExp("^"+t+"|\\s"+t,"i");return e.grep(s.source,function(e){return n.exec(e.name)!==null})},h=function(t){u=t,o=-1,u.length==0&&u.push(b());var r=["<ul>"];e.each(u,function(e,t){r.push('<li><a href="'+t.href+'">'+t.name+"</a></li>")}),r.push("</ul>"),n.html(r.join(""))},p=function(){y(),n.show(),e("#search").addClass("has-results"),e(document).bind("click.autocomplete",function(r){var i=n.get(0);r.target!==t.get(0)&&r.target!==i&&!e.contains(i,r.target)&&(d(),t.blur())}),s.onShow(t,n)},d=function(){n.hide(),e("#search").removeClass("has-results"),e(document).unbind("click.autocomplete"),s.onHide(t,n)},v=function(){var e=u.length;e>0&&o<e-1?g(o+1):o===e-1&&g(0)},m=function(){o!==-1?g(o-1):g(u.length-1)},g=function(e){n.find("li").removeClass("focused").filter(":nth-child("+(e+1)+")").addClass("focused"),o=e},y=function(){var e=t.offset();n.css({top:Math.round(e.top+i)+"px",left:Math.round(e.left+r)+"px"})},b=function(){return{name:"No matches found",id:null}};return f}(),t.NavigationToggler=function(t){var n=e(t),r=!1,i,s=function(){if(r)return;var t=e("#site-navigation");i=t.clone(),i.attr("id","site-top-navigation").css({visibility:"hidden"}),i.append('<a href="#" class="close"><span>St√§ng meny</span></a>'),i.find("a.close").bind("click",a),e("body").append(i);var n=document.createElement("style");n.id="navigation-styles",n.type="text/css",n.innerHTML=o(i),document.getElementsByTagName("head")[0].appendChild(n),r=!0},o=function(e){var t=e.outerHeight(),n="#site-top-navigation { margin-top: -"+t+"px; }";return n+="#site-top-navigation.inactive { margin-top: -"+t+"px; }",n},u=function(){if(!r){s();return}var e=document.getElementById("navigation-styles");e.innerHTML=o(e)},a=function(e){e.preventDefault(),i.addClass("inactive").removeClass("active")},f=function(e){e.preventDefault(),i.css("visibility","visible"),i.addClass("active").removeClass("inactive")};n.bind("click",f),e(document).bind("resize",function(){setTimeout(u,200)}),s()},t.focusAndCopy=function(t){var n=function(){var e=this;window.setTimeout(function(){e.select()},5)};e(t).bind("focus",n).bind("click",n)},t.voting=function(){e("div.voting").each(function(){var t=e(this),n=t.find("div.votable"),r=t.find("div.results");if(r.size()==0)return;r.hide(),n.append('<a href="#" class="show-results toggler">'+n.data("show-results-copy")+"</a>"),r.append('<a href="#" class="show-votable toggler">'+r.data("show-votable-copy")+"</a>"),t.delegate("button, a.show-results","click",function(e){console.log(e),e.preventDefault(),n.hide(),r.show()}),t.delegate("a.show-votable","click",function(e){e.preventDefault(),r.hide(),n.show()})})},e(document).ready(function(){t.NavigationToggler("#skip-to-navigation"),t.CookieChecker(),t.searchAsYouType("#topics-search",{source:function(){var t=e.map(e("#topics a"),function(t){return{name:e(t).text(),href:t.href}});return t.sort(function(e,t){return naturalSort(e.name,t.name)})},onShow:function(e){e.parent().addClass("active-suggestions")},onHide:function(e){e.parent().removeClass("active-suggestions")}}),e("section.tabbed").tabs(),e("#conversation-form").hide(),e("#go-to-form").bind("click",function(t){t.preventDefault();var n=e("#conversation-form");n.is(":visible")?e("#conversation-form").slideUp():e("#conversation-form").slideDown()}),t.focusAndCopy("input.share"),t.voting()})})(jQuery);